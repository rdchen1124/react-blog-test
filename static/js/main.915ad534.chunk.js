(this.webpackJsonphooks_todo=this.webpackJsonphooks_todo||[]).push([[0],{35:function(t,e,n){"use strict";n.r(e);var c,i,r,o,a,s,j=n(0),d=n(20),b=n.n(d),u=n(9),l=n(3),p=n(4),O=n(10),h=n(2),x=Object(j.createContext)(null),f="token",g=function(t){window.localStorage.setItem(f,t)},v=function(){return window.localStorage.getItem(f)},m=n(1),y=p.a.div(c||(c=Object(l.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 60px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.3);\n  box-sizing: border-box;\n  padding: 0px 32px; \n"]))),w=p.a.div(i||(i=Object(l.a)(["\n  display: flex;\n  align-items: center;\n  height: 60px;\n"]))),k=Object(p.a)(O.b)(r||(r=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  box-sizing: border-box;\n  height: 100%;\n  width: 100px;\n  cursor: pointer;\n  color: blue;\n  text-decoration: none;\n  ","\n"])),(function(t){return t.$active&&"\n    background: rgba(0, 0, 0, 0.2);\n  "})),S=p.a.div(o||(o=Object(l.a)(["\n  display: flex;\n  align-items: center;\n  "," {\n    margin-left: 10px;\n  }\n"])),w),z=p.a.div(a||(a=Object(l.a)(["\n  display: flex;\n"]))),C=p.a.div(s||(s=Object(l.a)(["\n  font-size: 32px;\n  font-weight:bold;\n"])));var I,_,E,$,J,P=function(){var t=Object(h.g)(),e=Object(j.useContext)(x),n=e.user,c=e.setUser,i=Object(h.f)();return Object(m.jsxs)(y,{children:[Object(m.jsxs)(S,{children:[Object(m.jsx)(C,{children:"Medium"}),Object(m.jsxs)(w,{children:[Object(m.jsx)(k,{to:"/",$active:"/"===t.pathname,children:"\u9996\u9801"}),n&&Object(m.jsx)(k,{to:"/post",$active:"/post"===t.pathname,children:"\u767c\u8868\u6587\u7ae0"})]})]}),Object(m.jsx)(z,{children:Object(m.jsxs)(w,{children:[!n&&Object(m.jsx)(k,{to:"/login",$active:"/login"===t.pathname,children:"\u767b\u5165"}),n&&Object(m.jsx)(k,{onClick:function(){g(""),c(null),"/"!==t.pathname&&i.push("/")},children:"\u767b\u51fa"})]})})]})},U=n(11),A=n.n(U),B="https://student-json-api.lidemy.me",D=function(){var t=v();return fetch("".concat(B,"/me"),{headers:{authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()}))},L=p.a.div(I||(I=Object(l.a)(["\n  width: 90%;\n  margin: 0 auto;\n"]))),N=p.a.div(_||(_=Object(l.a)(["\n  display: flex;\n  justify-content: space-between;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2); \n  padding: 16px;\n  align-items: flex-end;\n"]))),M=Object(p.a)(O.b)(E||(E=Object(l.a)(["\n  font-size: 20px;\n  color: seagreen;\n  text-decoration: none;\n"]))),T=p.a.div($||($=Object(l.a)(["\n  color: grey;\n"])));function q(t){var e=t.post;return Object(m.jsxs)(N,{children:[Object(m.jsx)(M,{to:"/posts/".concat(e.id),children:e.title}),Object(m.jsx)(T,{children:new Date(e.createdAt).toLocaleString()})]})}function F(){var t=Object(j.useState)([]),e=Object(u.a)(t,2),n=e[0],c=e[1];return Object(j.useEffect)((function(){fetch("".concat(B,"/posts?_sort=createdAt&_order=desc&_limit=5")).then((function(t){return t.json()})).then((function(t){return c(t)}))}),[]),Object(m.jsx)(L,{children:n&&n.map((function(t){return Object(m.jsx)(q,{post:t},t.id)}))})}q.prototype={post:A.a.object};var G,H,K,Q,R=p.a.div(J||(J=Object(l.a)(["\n  background: red;\n  color: white;\n  padding: 2px 5px;\n  width: 300px;\n"])));function V(){var t=Object(j.useContext)(x).setUser,e=Object(j.useState)(""),n=Object(u.a)(e,2),c=n[0],i=n[1],r=Object(j.useState)(""),o=Object(u.a)(r,2),a=o[0],s=o[1],d=Object(j.useState)(""),b=Object(u.a)(d,2),l=b[0],p=b[1],O=Object(h.f)();return Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),p(""),function(t,e){return fetch("".concat(B,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:e})}).then((function(t){return t.json()}))}(c,a).then((function(e){if(0===e.ok)return p(e.message);g(e.token),D().then((function(e){if(1!==e.ok)return g(null),p(e.message);t(e.data),O.push("/")}))}))},children:[Object(m.jsxs)("div",{children:["username: "," ",Object(m.jsx)("input",{type:"text",value:c,onChange:function(t){return i(t.target.value)}})]}),Object(m.jsxs)("div",{children:["password: "," ",Object(m.jsx)("input",{type:"password",value:a,onChange:function(t){return s(t.target.value)}})]}),Object(m.jsx)("button",{children:"send"}),l&&Object(m.jsx)(R,{children:l.toString()})]})}function W(){return Object(m.jsx)("div",{children:"Post article"})}var X,Y=p.a.div(G||(G=Object(l.a)(["\n  width: 90%;\n  margin: 0 auto;\n"]))),Z=p.a.div(H||(H=Object(l.a)(["\n  padding: 5px 10px;\n"]))),tt=p.a.div(K||(K=Object(l.a)(["\n  font-size: 28px;\n  font-weight: bold;\n  color: skyblue;\n"]))),et=p.a.div(Q||(Q=Object(l.a)(["\n  margin-top: 10px;\n  white-space: pre-line;\n  padding: 10px 0px;\n  border-top: 1px solid rgba(0, 0, 0, 0.2);\n"])));function nt(t){var e=t.article;return Object(m.jsxs)(Z,{children:[Object(m.jsx)(tt,{children:e.title}),Object(m.jsx)(et,{children:e.body})]})}function ct(){var t=Object(h.h)().postId,e=Object(j.useState)({}),n=Object(u.a)(e,2),c=n[0],i=n[1];return Object(j.useEffect)((function(){var e;(e=Number(t),fetch("".concat(B,"/posts?id=").concat(e)).then((function(t){return t.json()}))).then((function(t){return i(t[0])}))}),[t]),Object(m.jsx)(Y,{children:Object(m.jsx)(nt,{article:c})})}var it=p.a.div(X||(X=Object(l.a)(["\n  padding-top: 60px;\n"])));var rt=function(){var t=Object(j.useState)(null),e=Object(u.a)(t,2),n=e[0],c=e[1];return Object(j.useLayoutEffect)((function(){v()&&D().then((function(t){t.ok&&c(t.data)}))}),[]),Object(m.jsx)(x.Provider,{value:{user:n,setUser:c},children:Object(m.jsx)(it,{children:Object(m.jsxs)(O.a,{children:[Object(m.jsx)(P,{}),Object(m.jsxs)(h.c,{children:[Object(m.jsx)(h.a,{exact:!0,path:"/",children:Object(m.jsx)(F,{})}),Object(m.jsx)(h.a,{path:"/post",children:Object(m.jsx)(W,{})}),Object(m.jsx)(h.a,{path:"/posts/:postId",children:Object(m.jsx)(ct,{})}),Object(m.jsx)(h.a,{path:"/login",children:Object(m.jsx)(V,{})})]})]})})})};b.a.render(Object(m.jsx)(rt,{}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.915ad534.chunk.js.map